(function(n){"use strict";typeof define=="function"&&define.amd?define(function(t,i,r){r.exports=n(t("jquery"),t("devextreme/data/custom_store"),t("devextreme/data/utils"))}):DevExpress.data.AspNet=n(jQuery,DevExpress.data.CustomStore,DevExpress.data.utils)})(function(n,t,i){"use strict";function e(n){var i=new t(o(n));return i._useDefaultSearch=!0,i}function o(t){function e(t,i,r,u){var f=n.Deferred();return i&&!o?f.reject(new Error("Primary key is not specified (operation: '"+t+"', url: '"+r.url+"')")):(t==="load"&&(r.cache=!1),w&&w(t,r),n.ajax(r).done(function(n){u?u(f,n):f.resolve(n)}).fail(function(n,t){var i=a(n);i?f.reject(i):f.reject(n,t)})),f.promise()}function k(t){return n.isArray(o)?n.map(o,function(n){return[[n,t[n]]]}):[o,t]}function c(t,r){var u={};if(r&&(u.isCountQuery=r),t){n.each(["skip","take","requireTotalCount","requireGroupCount"],function(){this in t&&(u[this]=t[this])});var h=i.normalizeSortingInfo,e=t.group,o=t.filter,s=t.select;t.sort&&(u.sort=JSON.stringify(h(t.sort)));e&&(l(e)||(e=h(e)),u.group=JSON.stringify(e));n.isArray(o)&&(o=n.extend(!0,[],o),f(o),u.filter=JSON.stringify(o));t.totalSummary&&(u.totalSummary=JSON.stringify(t.totalSummary));t.groupSummary&&(u.groupSummary=JSON.stringify(t.groupSummary));s&&(n.isArray(s)||(s=[s]),u.select=JSON.stringify(s))}return n.extend(u,b),u}var o=t.key,s=t.loadUrl,b=t.loadParams,v=t.updateUrl,y=t.insertUrl,p=t.deleteUrl,w=t.onBeforeSend;return{key:o,load:function(n){return e("load",!1,{url:s,data:c(n)},function(n,t){r(n,t,function(n){return[n.data,h(n)]})})},totalCount:function(n){return e("load",!1,{url:s,data:c(n,!0)},function(n,t){r(n,t,function(n){return[n.totalCount]})})},byKey:function(n){return e("load",!0,{url:s,data:c({filter:k(n)})},function(n,t){r(n,t,function(n){return[n.data[0]]})})},update:v&&function(n,i){return e("update",!0,{url:v,type:t.updateMethod||"PUT",data:{key:u(n),values:JSON.stringify(i)}})},insert:y&&function(n){return e("insert",!0,{url:y,type:t.insertMethod||"POST",data:{values:JSON.stringify(n)}})},remove:p&&function(n){return e("delete",!0,{url:p,type:t.deleteMethod||"DELETE",data:{key:u(n)}})}}}function r(n,t,i){t=s(t);t&&typeof t=="object"?n.resolve.apply(n,i(t)):n.reject(new Error("Unexpected response received"))}function s(t){return n.isArray(t)?{data:t}:typeof t=="number"?{totalCount:t}:t}function h(n){return{totalCount:"totalCount"in n?n.totalCount:-1,groupCount:"groupCount"in n?n.groupCount:-1,summary:n.summary||null}}function u(n){return typeof n=="object"?JSON.stringify(n):n}function c(n){function t(n,t){for(n=String(n);n.length<t;)n="0"+n;return n}var i=[1+n.getMonth(),"/",n.getDate(),"/",n.getFullYear()],r=n.getHours(),u=n.getMinutes(),f=n.getSeconds(),e=n.getMilliseconds();return r+u+f+e>0&&i.push(" ",t(r,2),":",t(u,2),":",t(f,2),".",t(e,3)),i.join("")}function f(t){n.each(t,function(i,r){switch(n.type(r)){case"array":f(r);break;case"date":t[i]=c(r)}})}function l(t){if(!n.isArray(t))return!1;for(var i=0;i<t.length;i++)if("groupInterval"in t[i]||"isExpanded"in t[i])return!0;return!1}function a(t){var r=t.getResponseHeader("Content-Type"),u=t.responseText,i,f;if(!r)return null;if(r.indexOf("text/plain")===0)return u;if(r.indexOf("application/json")===0){if(i=v(u),typeof i=="string")return i;if(n.isPlainObject(i))for(f in i)if(typeof i[f]=="string")return i[f];return u}return null}function v(n){try{return JSON.parse(n)}catch(t){return null}}return{createStore:e}});